<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de baies non prot√©g√©es (CNB)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #fef7f2; }
        #app { max-width: 800px; margin: 0 auto; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        h1 { color: #333; text-align: center; }
        .tab-nav { overflow: hidden; background-color: #f1f1f1; border-bottom: 1px solid #ccc; }
        .tab-nav button { background-color: inherit; color: #333; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 16px; }
        .tab-nav button:hover { background-color: #ddd; }
        .tab-nav button.active { background-color: #004d99; color: white; }
        .tab-content { display: none; padding: 20px; border: 1px solid #ccc; border-top: none; }
        .tab-content.active { display: block; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin: 10px 0; font-size: 16px; }
        input[type="number"], select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { margin: 10px 0; padding: 10px 20px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        .results { background-color: #f1f1f1; padding: 20px; border-radius: 8px; margin-top: 20px; }
        .info { font-style: italic; font-size: 14px; color: #666; margin-top: 5px; }
        .tooltip { position: relative; display: inline-block; margin-left: 5px; vertical-align: top; }
        .tooltip .tooltip-icon { background-color: #aaaaaa; color: white; width: 16px; height: 16px; border-radius: 50%; display: inline-block; text-align: center; font-size: 11px; line-height: 16px; cursor: help; }
        .tooltip .tooltip-text { visibility: hidden; width: 250px; background-color: #555; color: #fff; text-align: left; border-radius: 6px; padding: 8px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -125px; opacity: 0; transition: opacity 0.3s; font-style: normal; font-size: 13px; }
        .tooltip:hover .tooltip-text { visibility: visible; opacity: 1; }
        .visual-box { display: none; }
        .copy-btn { background-color: #28a745; }
        .copy-btn:hover { background-color: #218838; }
        .section-title { background-color: #e9ecef; padding: 8px 12px; margin-top: 15px; border-radius: 4px; }
        .spacing-input { width: calc(50% - 10px); display: inline-block; }
        .spacing-input:first-child { margin-right: 10px; }
    </style>
</head>
<body>
    <div id="app">
        <h1>Calculateur de baies non prot√©g√©es (CNB)</h1>
        <div class="tab-nav">
            <button class="tab-link active" onclick="openTab(event, 'cnb')">M√©thode CNB (3.2.3.)</button>
            <button class="tab-link" onclick="openTab(event, 'method91014')">M√©thode 9.10.14</button>
            <button class="tab-link" onclick="openTab(event, 'method91015')">M√©thode 9.10.15</button>
        </div>

        <div id="cnb" class="tab-content active">
            <p>Calcul bas√© sur la section 3.2.3 du CNB</p>
            <div class="form-group">
                <label for="usage_cnb">Usage du b√¢timent <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Les usages sont class√©s par groupe selon leur risque d'incendie. Les groupes A, B3, C, D et F3 sont g√©n√©ralement √† risque moindre que les groupes E, F1 et F2.</span></div></label>
                <select id="usage_cnb">
                    <option value="groupes_A_B3_C_D_F3">Usages des groupes A, B division 3, C, D et F division 3</option>
                    <option value="groupes_E_F1_F2">Usages des groupes E et F divisions 1 et 2</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="construction_type_cnb">Type de construction <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 3.2.3.7, le type de construction a un impact sur les exigences. La construction incombustible offre g√©n√©ralement une meilleure r√©sistance au feu.</span></div></label>
                <select id="construction_type_cnb">
                    <option value="incombustible">Incombustible</option>
                    <option value="combustible">Combustible</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="revetement_type_cnb">Type de rev√™tement <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Le rev√™tement influe sur la propagation potentielle du feu. Les rev√™tements incombustibles offrent une meilleure protection.</span></div></label>
                <select id="revetement_type_cnb">
                    <option value="incombustible">Incombustible</option>
                    <option value="combustible">Combustible</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Protection par gicleurs <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Si le b√¢timent est prot√©g√© partiellement par gicleurs avec au moins un √©tage non prot√©g√©, vous devrez appliquer les conditions sp√©cifiques selon l'article 3.2.3.1. 8).</span></div></label>
                <select id="sprinklers_cnb">
                    <option value="none">Aucune protection par gicleurs</option>
                    <option value="complete">B√¢timent enti√®rement prot√©g√© par gicleurs</option>
                    <option value="partial">Protection partielle par gicleurs (certains √©tages non prot√©g√©s)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="distance_cnb">Distance limitative (m) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Distance entre la fa√ßade de rayonnement et la limite de propri√©t√©, l'axe d'une voie publique ou une ligne imaginaire entre deux b√¢timents sur le m√™me terrain.</span></div></label>
                <input type="number" id="distance_cnb" value="" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_cnb">Surface de la fa√ßade de rayonnement (m¬≤) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Surface totale de la fa√ßade ext√©rieure du mur orient√©e dans une m√™me direction, mesur√©e √† partir du niveau du sol jusqu'au plafond du dernier √©tage.</span></div></label>
                <input type="number" id="surface_cnb" value="" min="0">
            </div>
            
            <div class="form-group">
                <label for="length_cnb">Longueur de la fa√ßade (m)</label>
                <input type="number" id="length_cnb" value="" min="0">
            </div>
            
            <div class="form-group">
                <label for="height_cnb">Hauteur de la fa√ßade (m)</label>
                <input type="number" id="height_cnb" value="" min="0">
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="glass_brick_cnb"> Baies prot√©g√©es par briques de verre/verre arm√© <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 3.2.3.12, les baies prot√©g√©es par des briques de verre ou du verre arm√© permettent de doubler la surface maximale autoris√©e de baies non prot√©g√©es.</span></div></label>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_cnb"> Plus de 10 min d'intervention dans 10 % ou plus des cas <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon le paragraphe 3.2.3.1. 8), si le d√©lai d'intervention du service d'incendie est sup√©rieur √† 10 min dans 10% ou plus des cas, la distance limitative est divis√©e par 2 pour les calculs.</span></div></label>
            </div>

            <div class="section-title">Espacement des baies non prot√©g√©es</div>
            <div class="form-group">
                <label><input type="checkbox" id="check_spacing_cnb"> V√©rifier l'espacement minimal des baies <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 3.2.3.1. 6), les baies non prot√©g√©es doivent respecter un espacement minimal si elles servent une m√™me pi√®ce ou un m√™me espace.</span></div></label>
            </div>
            
            <div id="spacing_options_cnb" style="display: none;">
                <div class="form-group">
                    <label for="horizontal_spacing_cnb">Espacement horizontal entre baies (m)</label>
                    <input type="number" id="horizontal_spacing_cnb" value="2" min="0" step="0.1">
                </div>
                <div class="form-group">
                    <label for="vertical_spacing_cnb">Espacement vertical entre baies (m)</label>
                    <input type="number" id="vertical_spacing_cnb" value="2" min="0" step="0.1">
                </div>
            </div>

            <div class="section-title">M√©thode de l'aire pond√©r√©e</div>
            <div class="form-group">
                <label><input type="checkbox" id="weighted_area_cnb"> Utiliser la m√©thode de l'aire pond√©r√©e <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 3.2.3.1. 9), cette m√©thode permet de tenir compte du rayonnement thermique par la face non expos√©e d'un mur ayant une temp√©rature excessive.</span></div></label>
            </div>
            
            <div id="weighted_options_cnb" style="display: none;">
                <div class="form-group">
                    <label for="Tu_cnb">Temp√©rature superficielle moyenne (¬∞C)</label>
                    <input type="number" id="Tu_cnb" value="500" min="0">
                </div>
                <div class="form-group">
                    <label for="resistance_cnb">Degr√© de r√©sistance au feu</label>
                    <select id="resistance_cnb">
                        <option value="45">45 min</option>
                        <option value="60">1 h</option>
                        <option value="120">2 h</option>
                    </select>
                </div>
            </div>

            <div class="section-title">Protection des √©l√©ments externes</div>
            <div class="form-group">
                <label><input type="checkbox" id="check_soffit_cnb"> V√©rifier la protection des soffites <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 3.2.3.6, les soffites faisant saillie pr√®s de la limite de propri√©t√© doivent respecter des exigences sp√©cifiques.</span></div></label>
            </div>
            
            <div id="soffit_options_cnb" style="display: none;">
                <div class="form-group">
                    <label for="soffit_distance_cnb">Distance entre le soffite et la limite de propri√©t√© (m)</label>
                    <input type="number" id="soffit_distance_cnb" value="0.5" min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="soffit_protected_cnb"> Soffite prot√©g√© selon les exigences</label>
                </div>
            </div>

            <div class="form-group">
                <label for="proposed_area_cnb">Surface propos√©e de baies non prot√©g√©es (m¬≤) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Surface totale de baies non prot√©g√©es que vous souhaitez proposer pour cette fa√ßade de rayonnement.</span></div></label>
                <input type="number" id="proposed_area_cnb" value="" min="0">
            </div>

            <div class="form-group">
                <label for="exempt_building_cnb">B√¢timent exempt√© <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 3.2.3.10, certains b√¢timents comme les garages de stationnement √† √©tages ouverts ont des exemptions sp√©cifiques.</span></div></label>
                <select id="exempt_building_cnb">
                    <option value="none">Aucun</option>
                    <option value="parking">Garage de stationnement √† √©tages ouverts</option>
                    <option value="street_level">√âtage donnant sur une rue (au niveau de la rue)</option>
                </select>
            </div>
     
            <button id="calculate_cnb" onclick="calculateCNB()">Calculer</button>
            <button id="copy_cnb" class="copy-btn" onclick="copyToClipboard('cnb-result')" style="display: none;">üìã Copier les r√©sultats</button>
            
            <div id="cnb-result" class="results"></div>
        </div>
<div id="method91014" class="tab-content">
            <p>Calcul bas√© sur la sous-section 9.10.14 du CNB (Tableau 9.10.14.4-A)</p>
            <div class="form-group">
                <label for="usage_91014">Usage du b√¢timent <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">L'usage du b√¢timent d√©termine les pourcentages maximaux de baies non prot√©g√©es autoris√©s selon le tableau 9.10.14.4-A.</span></div></label>
                <select id="usage_91014">
                    <option value="habitation">Habitation, √©tablissement d'affaires et √©tablissement industriel √† risques faibles</option>
                    <option value="commercial">√âtablissement commercial et √©tablissement industriel √† risques moyens</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="building_type_91014">Type de b√¢timent <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Les garages et b√¢timents secondaires peuvent b√©n√©ficier d'exemptions selon 9.10.14.4(10-12) et 9.10.14.5(4-5).</span></div></label>
                <select id="building_type_91014">
                    <option value="standard">B√¢timent standard</option>
                    <option value="garage">Garage ou b√¢timent secondaire</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="distance_91014">Distance limitative (m) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Distance entre la fa√ßade de rayonnement et la limite de propri√©t√©, l'axe d'une voie publique ou une ligne imaginaire entre deux b√¢timents sur le m√™me terrain.</span></div></label>
                <input type="number" id="distance_91014" value="" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_91014">Surface de la fa√ßade de rayonnement (m¬≤) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Surface totale de la fa√ßade ext√©rieure du mur orient√©e dans une m√™me direction, mesur√©e √† partir du niveau du sol jusqu'au plafond du dernier √©tage.</span></div></label>
                <input type="number" id="surface_91014" value="" min="0">
            </div>
            
            <div class="form-group">
                <label for="exterior_finish_91014">Type de rev√™tement ext√©rieur <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Le type de rev√™tement est important pour les distances limitatives inf√©rieures √† 1,2 m, o√π des exigences plus strictes s'appliquent.</span></div></label>
                <select id="exterior_finish_91014">
                    <option value="combustible">Combustible</option>
                    <option value="incombustible">Incombustible</option>
                </select>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="glass_brick_91014"> Baies prot√©g√©es par briques de verre/verre arm√© <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.14.4.(6), ces types de protection permettent une majoration des baies non prot√©g√©es.</span></div></label>
            </div>
            
            <div class="form-group">
                <label>Protection par gicleurs <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.14.4.(7), un b√¢timent prot√©g√© par gicleurs peut b√©n√©ficier d'une majoration des baies non prot√©g√©es.</span></div></label>
                <select id="sprinklers_91014">
                    <option value="none">Aucune protection par gicleurs</option>
                    <option value="complete">B√¢timent enti√®rement prot√©g√© par gicleurs</option>
                    <option value="partial">Protection partielle par gicleurs (certains √©tages non prot√©g√©s)</option>
                </select>
            </div>

            <div class="form-group">
                <label><input type="checkbox" id="response_91014"> Plus de 10 min d'intervention dans 10 % ou plus des cas <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon le paragraphe 9.10.14.3. 1), si le d√©lai d'intervention du service d'incendie est sup√©rieur √† 10 min dans 10% ou plus des cas, la distance limitative est divis√©e par 2 pour les calculs.</span></div></label>
            </div>

            <div class="section-title">Protection des soffites</div>
            <div class="form-group">
                <label><input type="checkbox" id="check_soffit_91014"> V√©rifier la protection des soffites <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.14.5.(8-12), les soffites faisant saillie pr√®s de la limite de propri√©t√© doivent respecter des exigences sp√©cifiques.</span></div></label>
            </div>
            
            <div id="soffit_options_91014" style="display: none;">
                <div class="form-group">
                    <label for="soffit_distance_91014">Distance entre le soffite et la limite de propri√©t√© (m)</label>
                    <input type="number" id="soffit_distance_91014" value="0.5" min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="soffit_protected_91014"> Soffite prot√©g√© selon les exigences</label>
                </div>
            </div>

            <div class="section-title">Espacement des baies non prot√©g√©es</div>
            <div class="form-group">
                <label><input type="checkbox" id="check_spacing_91014"> V√©rifier l'espacement minimal des baies <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.14.4.(4), les baies non prot√©g√©es doivent respecter un espacement minimal si elles desservent une m√™me pi√®ce ou un m√™me espace.</span></div></label>
            </div>
            
            <div id="spacing_options_91014" style="display: none;">
                <div class="form-group">
                    <div class="spacing-input">
                        <label for="horizontal_spacing_91014">Espacement horizontal (m)</label>
                        <input type="number" id="horizontal_spacing_91014" value="2" min="0" step="0.1">
                    </div>
                    <div class="spacing-input">
                        <label for="vertical_spacing_91014">Espacement vertical (m)</label>
                        <input type="number" id="vertical_spacing_91014" value="2" min="0" step="0.1">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="distinction_91014">Type de baies <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Distinction importante: les baies vitr√©es sont une cat√©gorie sp√©cifique de baies non prot√©g√©es selon 9.10.14.</span></div></label>
                <select id="distinction_91014">
                    <option value="unprotected">Baies non prot√©g√©es</option>
                    <option value="glazed">Baies vitr√©es</option>
                </select>
            </div>

            <div class="form-group">
                <label for="proposed_area_91014">Surface propos√©e de baies non prot√©g√©es (m¬≤) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Surface totale de baies non prot√©g√©es que vous souhaitez proposer pour cette fa√ßade de rayonnement.</span></div></label>
                <input type="number" id="proposed_area_91014" value="" min="0">
            </div>
          
            <button id="calculate_91014" onclick="calculate91014()">Calculer</button>
            <button id="copy_91014" class="copy-btn" onclick="copyToClipboard('method91014-result')" style="display: none;">üìã Copier les r√©sultats</button>
            
            <div id="method91014-result" class="results"></div>
        </div>

        <div id="method91015" class="tab-content">
            <p>Calcul bas√© sur la sous-section 9.10.15 du CNB (Tableau 9.10.15.4) - Pour habitations</p>
            <div class="info">Cette m√©thode s'applique uniquement aux b√¢timents qui ne renferment que des logements et dont aucun des logements n'est situ√© au-dessus d'un autre logement.</div>
            
            <div class="form-group">
                <label for="housing_type_91015">Type d'habitation <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.15.1., les maisons comportant un logement accessoire suivent des r√®gles sp√©cifiques.</span></div></label>
                <select id="housing_type_91015">
                    <option value="standard">Habitation standard</option>
                    <option value="accessoire">Maison comportant un logement accessoire</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="distance_91015">Distance limitative (m) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Distance entre la fa√ßade de rayonnement et la limite de propri√©t√©, l'axe d'une voie publique ou une ligne imaginaire entre deux b√¢timents sur le m√™me terrain.</span></div></label>
                <input type="number" id="distance_91015" value="" min="0" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="surface_91015">Surface de la fa√ßade de rayonnement (m¬≤) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Surface totale de la fa√ßade ext√©rieure du mur orient√©e dans une m√™me direction, mesur√©e √† partir du niveau du sol jusqu'au plafond du dernier √©tage.</span></div></label>
                <input type="number" id="surface_91015" value="" min="0">
            </div>
            
            <div class="form-group">
                <label for="reveting_type_91015">Type de rev√™tement ext√©rieur <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.15.5, le type de rev√™tement a un impact sur les exigences de construction, particuli√®rement pour les distances limitatives faibles.</span></div></label>
                <select id="reveting_type_91015">
                    <option value="combustible">Combustible</option>
                    <option value="incombustible">Incombustible</option>
                </select>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="glass_brick_91015"> Baies prot√©g√©es par briques de verre/verre arm√© <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Ces types de protection permettent une majoration des baies non prot√©g√©es autoris√©es.</span></div></label>
            </div>
            
            <div class="form-group">
                <label>Protection par gicleurs <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Un b√¢timent prot√©g√© par gicleurs peut b√©n√©ficier d'exigences moins strictes.</span></div></label>
                <select id="sprinklers_91015">
                    <option value="none">Aucune protection par gicleurs</option>
                    <option value="complete">B√¢timent enti√®rement prot√©g√© par gicleurs</option>
                    <option value="partial">Protection partielle par gicleurs (certains √©tages non prot√©g√©s)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label><input type="checkbox" id="response_91015"> Plus de 10 min d'intervention dans 10 % ou plus des cas <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon le paragraphe 9.10.15.3. 1), si le d√©lai d'intervention du service d'incendie est sup√©rieur √† 10 min dans 10% ou plus des cas, la distance limitative est divis√©e par 2 pour les calculs.</span></div></label>
            </div>

            <div class="section-title">Protection des soffites</div>
            <div class="form-group">
                <label><input type="checkbox" id="check_soffit_91015"> V√©rifier la protection des soffites <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.15.5.(8-12), les soffites faisant saillie pr√®s de la limite de propri√©t√© doivent respecter des exigences sp√©cifiques.</span></div></label>
            </div>
            
            <div id="soffit_options_91015" style="display: none;">
                <div class="form-group">
                    <label for="soffit_distance_91015">Distance entre le soffite et la limite de propri√©t√© (m)</label>
                    <input type="number" id="soffit_distance_91015" value="0.5" min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="soffit_protected_91015"> Soffite prot√©g√© selon les exigences</label>
                </div>
            </div>

            <div class="section-title">Espacement des baies non prot√©g√©es</div>
            <div class="form-group">
                <label><input type="checkbox" id="check_spacing_91015"> V√©rifier l'espacement minimal des baies <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Selon 9.10.15.4.(4), les baies vitr√©es doivent respecter un espacement minimal si elles desservent une m√™me pi√®ce ou un m√™me espace.</span></div></label>
            <div id="spacing_options_91015" style="display: none;">
            <div class="form-group">
                <div class="spacing-input">
                    <label for="horizontal_spacing_91015">Espacement horizontal (m)</label>
                    <input type="number" id="horizontal_spacing_91015" value="2" min="0" step="0.1">
                </div>
                <div class="spacing-input">
                    <label for="vertical_spacing_91015">Espacement vertical (m)</label>
                    <input type="number" id="vertical_spacing_91015" value="2" min="0" step="0.1">
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="distinction_91015">Type de baies <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">La sous-section 9.10.15 fait sp√©cifiquement r√©f√©rence aux baies vitr√©es, qui sont une cat√©gorie de baies non prot√©g√©es.</span></div></label>
           <select id="distinction_91015">
               <option value="unprotected">Baies non prot√©g√©es</option>
               <option value="glazed">Baies vitr√©es</option>
           </select>
       </div>

       <div class="form-group">
           <label for="proposed_area_91015">Surface propos√©e de baies non prot√©g√©es (m¬≤) <div class="tooltip"><span class="tooltip-icon">?</span><span class="tooltip-text">Surface totale de baies non prot√©g√©es que vous souhaitez proposer pour cette fa√ßade de rayonnement.</span></div></label>
           <input type="number" id="proposed_area_91015" value="" min="0">
       </div>
  
       <button id="calculate_91015" onclick="calculate91015()">Calculer</button>
       <button id="copy_91015" class="copy-btn" onclick="copyToClipboard('method91015-result')" style="display: none;">üìã Copier les r√©sultats</button>
       
       <div id="method91015-result" class="results"></div>
   </div>
</div>

<script>
   // Tableau 3.2.3.1.-B - Usages des groupes A, B3, C, D et F3 - Sans gicleurs
   const tableauGroupesAB3CDF3 = {
       10: {
           "< 3:1": [0, 8, 10, 18, 29, 46, 91, 100],
           "3:1 √† 10:1": [0, 8, 12, 21, 33, 50, 96, 100],
           "> 10:1": [0, 11, 18, 32, 48, 68, 100]
       },
       15: {
           "< 3:1": [0, 7, 9, 14, 22, 33, 63, 100],
           "3:1 √† 10:1": [0, 8, 10, 17, 25, 37, 67, 100],
           "> 10:1": [0, 10, 15, 26, 39, 53, 87, 100]
       },
       20: {
           "< 3:1": [0, 7, 9, 12, 18, 26, 49, 81, 100],
           "3:1 √† 10:1": [0, 8, 10, 15, 21, 30, 53, 85, 100],
           "> 10:1": [0, 9, 14, 23, 33, 45, 72, 100]
       },
       25: {
           "< 3:1": [0, 7, 8, 11, 16, 23, 41, 66, 98, 100],
           "3:1 √† 10:1": [0, 8, 9, 13, 19, 26, 45, 70, 100],
           "> 10:1": [0, 9, 13, 21, 30, 39, 62, 90, 100]
       },
       30: {
           "< 3:1": [0, 7, 8, 11, 15, 20, 35, 56, 83, 100],
           "3:1 √† 10:1": [0, 7, 9, 12, 17, 23, 39, 61, 88, 100],
           "> 10:1": [0, 8, 12, 19, 27, 36, 56, 79, 100]
       },
       40: {
           "< 3:1": [0, 7, 8, 10, 13, 17, 28, 44, 64, 89, 100],
           "3:1 √† 10:1": [0, 7, 8, 11, 15, 20, 32, 48, 69, 93, 100],
           "> 10:1": [0, 8, 11, 17, 24, 31, 47, 66, 88, 100]
       },
       50: {
           "< 3:1": [0, 7, 8, 9, 12, 15, 24, 37, 53, 72, 96, 100],
           "3:1 √† 10:1": [0, 7, 8, 10, 14, 18, 28, 41, 57, 77, 100],
           "> 10:1": [0, 8, 10, 15, 21, 28, 41, 57, 76, 97, 100]
       },
       60: {
           "< 3:1": [0, 7, 8, 9, 11, 14, 21, 32, 45, 62, 81, 100],
           "3:1 √† 10:1": [0, 7, 8, 10, 13, 16, 25, 36, 49, 66, 85, 100],
           "> 10:1": [0, 8, 10, 14, 20, 25, 38, 51, 67, 85, 100]
       },
       80: {
           "< 3:1": [0, 7, 7, 8, 10, 12, 18, 26, 36, 48, 62, 79, 98, 100],
           "3:1 √† 10:1": [0, 7, 8, 9, 11, 14, 21, 29, 40, 52, 67, 84, 100],
           "> 10:1": [0, 8, 9, 13, 17, 22, 32, 44, 56, 70, 86, 100]
       },
       100: {
           "< 3:1": [0, 7, 7, 8, 9, 11, 16, 22, 30, 40, 51, 65, 80, 97, 100],
           "3:1 √† 10:1": [0, 7, 8, 9, 11, 13, 18, 25, 34, 44, 56, 69, 84, 100],
           "> 10:1": [0, 7, 9, 12, 16, 20, 29, 39, 49, 61, 74, 89, 100]
       },
       150: {
           "< 3:1": [0, 7, 7, 8, 9, 10, 13, 17, 22, 29, 37, 46, 56, 67, 79, 93, 100],
           "3:1 √† 10:1": [0, 7, 7, 8, 10, 11, 15, 20, 26, 33, 41, 50, 60, 71, 84, 97, 100],
           "> 10:1": [0, 7, 8, 11, 13, 17, 24, 31, 39, 48, 57, 68, 79, 91, 100]
       },
       250: {
           "< 3:1": [0, 7, 7, 7, 8, 9, 10, 13, 16, 20, 25, 30, 36, 43, 51, 59, 68, 87, 100],
           "3:1 √† 10:1": [0, 7, 7, 8, 9, 10, 12, 15, 19, 24, 28, 34, 40, 47, 55, 63, 72, 92, 100],
           "> 10:1": [0, 7, 8, 9, 11, 14, 19, 24, 30, 36, 43, 50, 57, 65, 73, 82, 92, 100]
       },
       350: {
           "< 3:1": [0, 7, 7, 7, 8, 8, 9, 11, 14, 16, 20, 24, 28, 33, 38, 44, 50, 64, 81, 99, 100],
           "3:1 √† 10:1": [0, 7, 7, 8, 8, 9, 11, 13, 16, 19, 23, 27, 32, 37, 42, 48, 55, 69, 85, 100],
           "> 10:1": [0, 7, 8, 9, 10, 12, 16, 21, 25, 30, 36, 41, 47, 53, 59, 66, 73, 88, 100]
       },
       500: {
           "< 3:1": [0, 7, 7, 7, 7, 8, 9, 10, 12, 14, 16, 19, 22, 25, 29, 33, 37, 47, 59, 71, 100],
           "3:1 √† 10:1": [0, 7, 7, 7, 8, 8, 10, 12, 14, 16, 19, 22, 25, 29, 33, 37, 41, 52, 63, 76, 100],
           "> 10:1": [0, 7, 7, 8, 9, 11, 14, 18, 22, 25, 30, 34, 38, 43, 48, 53, 58, 70, 82, 96, 100]
       },
       1000: {
           "< 3:1": [0, 7, 7, 7, 7, 7, 8, 9, 9, 10, 12, 13, 14, 16, 18, 20, 22, 27, 33, 39, 58, 82, 100],
           "3:1 √† 10:1": [0, 7, 7, 7, 7, 8, 9, 10, 11, 12, 14, 15, 17, 19, 21, 23, 26, 31, 37, 43, 63, 86, 100],
           "> 10:1": [0, 7, 7, 8, 8, 9, 11, 13, 16, 19, 21, 24, 27, 30, 33, 36, 39, 46, 53, 60, 82, 100]
       },
       2000: {
           "< 3:1": [0, 7, 7, 7, 7, 7, 7, 8, 8, 9, 9, 10, 11, 12, 13, 14, 15, 17, 20, 23, 33, 44, 58, 74, 93, 100],
           "3:1 √† 10:1": [0, 7, 7, 7, 7, 7, 8, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 20, 23, 27, 37, 49, 63, 79, 97, 100],
           "> 10:1": [0, 7, 7, 7, 8, 8, 9, 11, 12, 14, 16, 18, 19, 21, 23, 25, 27, 32, 36, 40, 53, 66, 82, 99, 100]
       }
   };
   
   // Tableau 3.2.3.1.-C - Usages des groupes E, F1 et F2 - Sans gicleurs
   const tableauGroupesEF1F2 = {
       10: {
           "< 3:1": [0, 4, 5, 9, 15, 23, 46, 77, 100],
           "3:1 √† 10:1": [0, 4, 6, 10, 17, 25, 48, 79, 100],
           "> 10:1": [0, 5, 9, 16, 24, 34, 58, 91, 100]
       },
       15: {
           "< 3:1": [0, 4, 5, 7, 11, 16, 32, 53, 79, 100],
           "3:1 √† 10:1": [0, 4, 5, 8, 13, 18, 34, 55, 82, 100],
           "> 10:1": [0, 5, 8, 13, 19, 26, 43, 66, 93, 100]
       },
       20: {
           "< 3:1": [0, 4, 4, 6, 9, 13, 25, 40, 61, 85, 100],
           "3:1 √† 10:1": [0, 4, 5, 7, 11, 15, 27, 43, 63, 87, 100],
           "> 10:1": [0, 5, 7, 11, 17, 22, 36, 53, 74, 99, 100]
       },
       25: {
           "< 3:1": [0, 4, 4, 6, 8, 11, 20, 33, 49, 69, 92, 100],
           "3:1 √† 10:1": [0, 4, 5, 7, 9, 13, 22, 35, 51, 71, 94, 100],
           "> 10:1": [0, 4, 6, 10, 15, 20, 31, 45, 62, 82, 100]
       },
       30: {
           "< 3:1": [0, 4, 4, 5, 7, 10, 18, 28, 42, 58, 77, 100],
           "3:1 √† 10:1": [0, 4, 4, 6, 9, 12, 20, 30, 44, 60, 80, 100],
           "> 10:1": [0, 4, 6, 10, 14, 18, 28, 40, 54, 71, 91, 100]
       },
       40: {
           "< 3:1": [0, 4, 4, 5, 6, 8, 14, 22, 32, 44, 59, 76, 94, 100],
           "3:1 √† 10:1": [0, 4, 4, 6, 8, 10, 16, 24, 34, 47, 61, 78, 97, 100],
           "> 10:1": [0, 4, 5, 8, 12, 15, 23, 33, 44, 57, 72, 89, 100]
       },
       50: {
           "< 3:1": [0, 4, 4, 5, 6, 7, 12, 18, 26, 36, 48, 61, 76, 93, 100],
           "3:1 √† 10:1": [0, 4, 4, 5, 7, 9, 14, 20, 29, 38, 50, 63, 79, 95, 100],
           "> 10:1": [0, 4, 5, 8, 11, 14, 21, 29, 38, 48, 61, 74, 90, 100]
       },
       60: {
           "< 3:1": [0, 4, 4, 4, 5, 7, 11, 16, 23, 31, 40, 52, 64, 78, 94, 100],
           "3:1 √† 10:1": [0, 4, 4, 5, 6, 8, 12, 18, 25, 33, 43, 54, 66, 81, 96, 100],
           "> 10:1": [0, 4, 5, 7, 10, 13, 19, 26, 34, 43, 53, 64, 77, 92, 100]
       },
       80: {
           "< 3:1": [0, 4, 4, 4, 5, 6, 9, 13, 18, 24, 31, 40, 49, 60, 71, 84, 98, 100],
           "3:1 √† 10:1": [0, 4, 4, 5, 6, 7, 10, 15, 20, 26, 33, 42, 51, 62, 74, 86, 100],
           "> 10:1": [0, 4, 5, 6, 9, 11, 16, 22, 28, 35, 43, 52, 62, 73, 85, 98, 100]
       },
       100: {
           "< 3:1": [0, 4, 4, 4, 5, 5, 8, 11, 15, 20, 26, 32, 40, 48, 58, 68, 79, 100],
           "3:1 √† 10:1": [0, 4, 4, 4, 5, 6, 9, 13, 17, 22, 28, 35, 42, 51, 60, 70, 81, 100],
           "> 10:1": [0, 4, 4, 6, 8, 10, 14, 19, 25, 31, 37, 44, 52, 61, 71, 81, 92, 100]
       },
       150: {
           "< 3:1": [0, 4, 4, 4, 4, 5, 6, 8, 11, 14, 18, 23, 28, 33, 40, 46, 54, 70, 89, 100],
           "3:1 √† 10:1": [0, 4, 4, 4, 5, 6, 8, 10, 13, 16, 20, 25, 30, 36, 42, 49, 56, 73, 92, 100],
           "> 10:1": [0, 4, 4, 5, 7, 8, 12, 16, 20, 24, 29, 34, 39, 46, 52, 59, 67, 84, 100]
       },
       250: {
           "< 3:1": [0, 4, 4, 4, 4, 4, 5, 7, 8, 10, 12, 15, 18, 22, 25, 29, 34, 44, 55, 68, 100],
           "3:1 √† 10:1": [0, 4, 4, 4, 4, 5, 6, 8, 10, 12, 14, 17, 20, 24, 27, 32, 36, 46, 57, 70, 100],
         "> 10:1": [0, 4, 4, 5, 6, 7, 9, 12, 15, 18, 21, 25, 28, 32, 37, 41, 46, 56, 68, 81, 100]
       },
       350: {
           "< 3:1": [0, 4, 4, 4, 4, 4, 5, 6, 7, 8, 10, 12, 14, 16, 19, 22, 25, 32, 40, 49, 77, 100],
           "3:1 √† 10:1": [0, 4, 4, 4, 4, 4, 5, 7, 8, 10, 12, 14, 16, 18, 21, 24, 27, 34, 43, 52, 79, 100],
           "> 10:1": [0, 4, 4, 4, 5, 6, 8, 10, 13, 15, 18, 21, 23, 26, 30, 33, 36, 44, 53, 62, 90, 100]
       },
       500: {
           "< 3:1": [0, 4, 4, 4, 4, 4, 4, 5, 6, 7, 8, 9, 11, 13, 14, 16, 19, 24, 29, 36, 55, 78, 100],
           "3:1 √† 10:1": [0, 4, 4, 4, 4, 4, 5, 6, 7, 8, 9, 11, 13, 14, 16, 18, 21, 26, 31, 38, 57, 80, 100],
           "> 10:1": [0, 4, 4, 4, 5, 5, 7, 9, 11, 13, 15, 17, 19, 21, 24, 26, 29, 35, 41, 48, 68, 92, 100]
       },
       1000: {
           "< 3:1": [0, 4, 4, 4, 4, 4, 4, 4, 5, 5, 6, 6, 7, 8, 9, 10, 11, 14, 16, 20, 29, 41, 55, 71, 89, 100],
           "3:1 √† 10:1": [0, 4, 4, 4, 4, 4, 4, 5, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 18, 22, 31, 43, 57, 73, 91, 100],
           "> 10:1": [0, 4, 4, 4, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 18, 20, 23, 26, 30, 41, 53, 68, 84, 100]
       },
       2000: {
           "< 3:1": [0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 6, 6, 7, 7, 9, 10, 12, 16, 22, 29, 37, 46, 56, 68, 80, 94, 100],
           "3:1 √† 10:1": [0, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 6, 6, 7, 7, 8, 9, 10, 12, 13, 18, 24, 31, 39, 49, 59, 70, 83, 96, 100],
           "> 10:1": [0, 4, 4, 4, 4, 4, 5, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 26, 33, 41, 50, 59, 70, 81, 94, 100]
       }
   };
   
   // Tableau 3.2.3.1.-D - B√¢timent prot√©g√© par gicleurs - Usages des groupes A, B, C, D et F3
   const tableauAvecGicleursGroupesABCDF3 = {
       10: [0, 16, 24, 42, 66, 100],
       15: [0, 16, 20, 34, 50, 74, 100],
       20: [0, 16, 20, 30, 42, 60, 100],
       25: [0, 16, 18, 26, 38, 52, 90, 100],
       30: [0, 14, 18, 24, 34, 46, 78, 100],
       40: [0, 14, 16, 22, 30, 40, 64, 96, 100],
       50: [0, 14, 16, 20, 28, 36, 56, 82, 100],
       60: [0, 14, 16, 20, 26, 32, 50, 72, 98, 100],
       80: [0, 14, 16, 18, 22, 28, 42, 58, 80, 100],
       100: [0, 14, 16, 18, 22, 26, 36, 50, 68, 88, 100],
       150: [0, 14, 14, 16, 20, 22, 30, 40, 52, 66, 82, 100]
   };
   
   // Tableau 3.2.3.1.-E - B√¢timent prot√©g√© par gicleurs - Usages des groupes E, F1 et F2
   const tableauAvecGicleursGroupesEF1F2 = {
       10: [0, 8, 12, 20, 34, 50, 96, 100],
       15: [0, 8, 10, 16, 26, 36, 68, 100],
       20: [0, 8, 10, 14, 22, 30, 54, 86, 100],
       25: [0, 8, 10, 14, 18, 26, 44, 70, 100],
       30: [0, 8, 8, 12, 18, 24, 40, 60, 88, 100],
       40: [0, 8, 8, 12, 16, 20, 32, 48, 68, 94, 100],
       50: [0, 8, 8, 10, 14, 18, 28, 40, 58, 76, 100],
       60: [0, 8, 8, 10, 12, 16, 24, 36, 50, 66, 86, 100],
       80: [0, 8, 8, 10, 12, 14, 20, 30, 40, 52, 66, 84, 100],
       100: [0, 8, 8, 8, 10, 12, 18, 26, 34, 44, 56, 70, 84, 100],
       150: [0, 8, 8, 8, 10, 12, 16, 20, 26, 32, 40, 50, 60, 72, 84, 98, 100],
       200: [0, 8, 8, 8, 8, 10, 14, 18, 22, 28, 34, 42,50, 60, 68, 80, 92, 100]
   };

   const limitingDistancesNoSprinklers = [0, 1.2, 1.5, 2.0, 2.5, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70];
   const limitingDistancesWithSprinklersABCDF3 = [0, 1.2, 1.5, 2.0, 2.5, 3, 4, 5, 6, 7, 8, 9];
   const limitingDistancesWithSprinklersEF1F2 = [0, 1.2, 1.5, 2.0, 2.5, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
   const facadeSurfaces = [10, 15, 20, 25, 30, 40, 50, 60, 80, 100, 150, 250, 350, 500, 1000, 2000];
   const facadeSurfacesWithSprinklersABCDF3 = [10, 15, 20, 25, 30, 40, 50, 60, 80, 100, 150, 250, 350, 500, 1000, 2000];
   const facadeSurfacesWithSprinklersEF1F2 = [10, 15, 20, 25, 30, 40, 50, 60, 80, 100, 150, 200];

   // Afficher/masquer les options suppl√©mentaires
   document.addEventListener('DOMContentLoaded', function() {
       // Gestionnaires d'√©v√©nements pour les checkboxes de v√©rification d'espacement
       document.getElementById('check_spacing_cnb').addEventListener('change', function() {
           document.getElementById('spacing_options_cnb').style.display = this.checked ? 'block' : 'none';
       });
                       
       document.getElementById('check_spacing_91014').addEventListener('change', function() {
           document.getElementById('spacing_options_91014').style.display = this.checked ? 'block' : 'none';
       });
       
       document.getElementById('check_spacing_91015').addEventListener('change', function() {
               document.getElementById('spacing_options_91015').style.display = this.checked ? 'block' : 'none';
           });
           
           // Gestionnaires d'√©v√©nements pour les checkboxes de v√©rification des soffites
           document.getElementById('check_soffit_cnb').addEventListener('change', function() {
               document.getElementById('soffit_options_cnb').style.display = this.checked ? 'block' : 'none';
           });
           
           document.getElementById('check_soffit_91014').addEventListener('change', function() {
               document.getElementById('soffit_options_91014').style.display = this.checked ? 'block' : 'none';
           });
           
           document.getElementById('check_soffit_91015').addEventListener('change', function() {
               document.getElementById('soffit_options_91015').style.display = this.checked ? 'block' : 'none';
           });
           
           // Gestionnaire d'√©v√©nement pour la m√©thode de l'aire pond√©r√©e
           document.getElementById('weighted_area_cnb').addEventListener('change', function() {
               document.getElementById('weighted_options_cnb').style.display = this.checked ? 'block' : 'none';
           });
           
           // Ajouter des √©couteurs pour l'onglet CNB
           const cnbInputs = document.querySelectorAll('#cnb input[type="number"]');
           cnbInputs.forEach(input => {
               input.addEventListener('keypress', function(event) {
                   handleEnterKey(event, calculateCNB);
               });
           });

           // Ajouter des √©couteurs pour l'onglet 9.10.14
           const inputs91014 = document.querySelectorAll('#method91014 input[type="number"]');
           inputs91014.forEach(input => {
               input.addEventListener('keypress', function(event) {
                   handleEnterKey(event, calculate91014);
               });
           });

           // Ajouter des √©couteurs pour l'onglet 9.10.15
           const inputs91015 = document.querySelectorAll('#method91015 input[type="number"]');
           inputs91015.forEach(input => {
               input.addEventListener('keypress', function(event) {
                   handleEnterKey(event, calculate91015);
               });
           });
       });

       function getRatioCategory(length, height) {
           const ratioLH = length / height;
           const ratioHL = height / length;
           const maxRatio = Math.max(ratioLH, ratioHL);
           if (maxRatio < 3) return "< 3:1";
           if (maxRatio <= 10) return "3:1 √† 10:1";
           return "> 10:1";
       }

       function interpolate(x, x1, x2, y1, y2) {
           if (x1 === x2) return y1;
           return y1 + (y2 - y1) * (x - x1) / (x2 - x1);
       }

       function findBounds(value, array) {
           // Si la valeur est inf√©rieure au premier √©l√©ment
           if (value <= array[0]) {
               return { lower: array[0], upper: array[1] };
           }
           // Si la valeur est sup√©rieure au dernier √©l√©ment
           if (value >= array[array.length - 1]) {
               return { lower: array[array.length - 2], upper: array[array.length - 1] };
           }
           // Recherche des bornes
           for (let i = 0; i < array.length - 1; i++) {
               if (value >= array[i] && value <= array[i + 1]) {
                   return { lower: array[i], upper: array[i + 1] };
               }
           }
           return { lower: array[0], upper: array[1] }; // Valeur par d√©faut
       }

       function calculateCNB() {
           const facadeSurface = parseFloat(document.getElementById('surface_cnb').value);
           const length = parseFloat(document.getElementById('length_cnb').value);
           const height = parseFloat(document.getElementById('height_cnb').value);
           let limitingDistance = parseFloat(document.getElementById('distance_cnb').value);
           const sprinklersOption = document.getElementById('sprinklers_cnb').value;
           const response = document.getElementById('response_cnb').checked;
           const usage = document.getElementById('usage_cnb').value;
           const constructionType = document.getElementById('construction_type_cnb').value;
           const revetementType = document.getElementById('revetement_type_cnb').value;
           const glassBrick = document.getElementById('glass_brick_cnb').checked;
           const exemptBuilding = document.getElementById('exempt_building_cnb').value;
           const proposedArea = parseFloat(document.getElementById('proposed_area_cnb').value);
           const checkSpacing = document.getElementById('check_spacing_cnb').checked;
           const horizontalSpacing = parseFloat(document.getElementById('horizontal_spacing_cnb').value);
           const verticalSpacing = parseFloat(document.getElementById('vertical_spacing_cnb').value);
           const checkSoffit = document.getElementById('check_soffit_cnb').checked;
           const soffit_distance = parseFloat(document.getElementById('soffit_distance_cnb').value);
           const soffit_protected = document.getElementById('soffit_protected_cnb').checked;
           const weightedArea = document.getElementById('weighted_area_cnb').checked;
           const Tu = parseFloat(document.getElementById('Tu_cnb').value);
           const resistanceAuFeu = document.getElementById('resistance_cnb').value;

           // V√©rification des entr√©es
           if (isNaN(facadeSurface) || isNaN(length) || isNaN(height) || isNaN(limitingDistance) || 
               facadeSurface <= 0 || length <= 0 || height <= 0 || limitingDistance < 0) {
               document.getElementById('cnb-result').innerHTML = "Erreur : Veuillez entrer des valeurs num√©riques valides.";
               return;
           }
           
           // V√©rifier si le b√¢timent est exempt√©
           if (exemptBuilding !== "none") {
               let exemptMessage = "";
               if (exemptBuilding === "parking" && limitingDistance >= 3) {
                   exemptMessage = `
                       <strong>B√¢timent exempt√© - Garage de stationnement √† √©tages ouverts :</strong><br>
                       Selon l'article 3.2.3.10. 1), les fa√ßades de rayonnement d'un garage de stationnement dont 
                       tous les √©tages sont des √©tages ouverts peuvent comporter des baies non prot√©g√©es sans 
                       limitation de surface si la distance limitative est d'au moins 3 m.<br><br>
                       <strong>Surface maximale des baies non prot√©g√©es : 100%</strong>
                   `;
               } else if (exemptBuilding === "street_level" && limitingDistance >= 9) {
                   exemptMessage = `
                       <strong>B√¢timent exempt√© - Fa√ßade donnant sur une rue :</strong><br>
                       Selon l'article 3.2.3.10. 2), la partie de la fa√ßade de rayonnement donnant sur une rue peut 
                       comporter, √† l'√©tage qui se trouve au niveau de la rue, des baies non prot√©g√©es sans 
                       limitation de surface si la distance limitative est d'au moins 9 m.<br><br>
                       <strong>Surface maximale des baies non prot√©g√©es : 100%</strong>
                   `;
               } else {
                   exemptMessage = `
                       <strong>B√¢timent exempt√© - Conditions non satisfaites :</strong><br>
                       Le b√¢timent que vous avez s√©lectionn√© pourrait √™tre exempt√©, mais les conditions ne sont pas satisfaites.<br>
                       ${exemptBuilding === "parking" ? 
                           "- Pour un garage de stationnement √† √©tages ouverts, la distance limitative doit √™tre d'au moins 3 m." : 
                           "- Pour une fa√ßade donnant sur une rue, la distance limitative doit √™tre d'au moins 9 m."}
                   `;
               }
               
               if (exemptMessage.includes("100%")) {
                   document.getElementById('copy_cnb').style.display = 'inline-block';
                   document.getElementById('cnb-result').innerHTML = exemptMessage;
                   return;
               } else {
                   // Continuer le calcul normalement
               }
           }

           // Ajustement pour le d√©lai d'intervention
           if (response) {
               limitingDistance = limitingDistance / 2;
           }

           const ratioCategory = getRatioCategory(length, height);
           
           // D√©terminer si le b√¢timent est prot√©g√© par gicleurs ou non
           const sprinklers = sprinklersOption === "complete";
           const partialSprinklers = sprinklersOption === "partial";
           
           // Choix du tableau selon l'usage et les gicleurs
           let tableToUse, distancesToUse, surfacesToUse;
           
           if (sprinklers && !partialSprinklers) {
               if (usage === "groupes_A_B3_C_D_F3") {
                   tableToUse = tableauAvecGicleursGroupesABCDF3;
                   distancesToUse = limitingDistancesWithSprinklersABCDF3;
                   surfacesToUse = facadeSurfacesWithSprinklersABCDF3;
               } else {
                   tableToUse = tableauAvecGicleursGroupesEF1F2;
                   distancesToUse = limitingDistancesWithSprinklersEF1F2;
                   surfacesToUse = facadeSurfacesWithSprinklersEF1F2;
               }
           } else {
               distancesToUse = limitingDistancesNoSprinklers;
               surfacesToUse = facadeSurfaces;
               if (usage === "groupes_A_B3_C_D_F3") {
                   tableToUse = tableauGroupesAB3CDF3;
               } else {
                   tableToUse = tableauGroupesEF1F2;
               }
           }

           // Si la distance limitative d√©passe la plage du tableau
           if (limitingDistance > distancesToUse[distancesToUse.length - 1]) {
               const resultHTML = `
                   <strong>Distance limitative (${limitingDistance.toFixed(2)} m) sup√©rieure aux valeurs du tableau.</strong><br>
                   Surface maximale des baies non prot√©g√©es : 100% (${facadeSurface.toFixed(2)} m¬≤)
               `;
               document.getElementById('cnb-result').innerHTML = resultHTML;
               document.getElementById('copy_cnb').style.display = 'inline-block';
               
               return;
           }

           // Trouver les bornes pour l'interpolation de distance
           const { lower: lowerDistance, upper: upperDistance } = findBounds(limitingDistance, distancesToUse);
           const lowerDistanceIndex = distancesToUse.indexOf(lowerDistance);
           const upperDistanceIndex = distancesToUse.indexOf(upperDistance);

           // Trouver les surfaces les plus proches pour l'interpolation
           // Recherche des surfaces encadrantes
           let lowerSurface = surfacesToUse[0];
           let upperSurface = surfacesToUse[surfacesToUse.length - 1];

           for (let i = 0; i < surfacesToUse.length - 1; i++) {
               if (facadeSurface >= surfacesToUse[i] && facadeSurface <= surfacesToUse[i + 1]) {
                   lowerSurface = surfacesToUse[i];
                   upperSurface = surfacesToUse[i + 1];
                   break;
               }
           }

           // Si la fa√ßade est plus petite que la plus petite surface du tableau
           if (facadeSurface < surfacesToUse[0]) {
               lowerSurface = surfacesToUse[0];
               upperSurface = surfacesToUse[1];
           }
           
           // Si la fa√ßade est plus grande que la plus grande surface du tableau
           if (facadeSurface > surfacesToUse[surfacesToUse.length - 1]) {
               lowerSurface = surfacesToUse[surfacesToUse.length - 2];
               upperSurface = surfacesToUse[surfacesToUse.length - 1];
           }

           let lowerSurfacePercentageLower, lowerSurfacePercentageUpper;
           let upperSurfacePercentageLower, upperSurfacePercentageUpper;

           // Extraire les pourcentages et interpoler selon que le b√¢timent est prot√©g√© par gicleurs ou non
           if (sprinklers && !partialSprinklers) {
               // Avec gicleurs (pas de ratio)
               lowerSurfacePercentageLower = tableToUse[lowerSurface][lowerDistanceIndex];
               lowerSurfacePercentageUpper = tableToUse[lowerSurface][upperDistanceIndex];
               
               upperSurfacePercentageLower = tableToUse[upperSurface][lowerDistanceIndex];
               upperSurfacePercentageUpper = tableToUse[upperSurface][upperDistanceIndex];
           } else {
               // Sans gicleurs ou protection partielle (avec ratio)
               lowerSurfacePercentageLower = tableToUse[lowerSurface][ratioCategory][lowerDistanceIndex];
               lowerSurfacePercentageUpper = tableToUse[lowerSurface][ratioCategory][upperDistanceIndex];
               
               upperSurfacePercentageLower = tableToUse[upperSurface][ratioCategory][lowerDistanceIndex];
               upperSurfacePercentageUpper = tableToUse[upperSurface][ratioCategory][upperDistanceIndex];
           }

           // Interpolation des pourcentages pour la distance limitative
           const lowerSurfacePercentage = interpolate(
               limitingDistance,
               lowerDistance,
               upperDistance,
               lowerSurfacePercentageLower,
               lowerSurfacePercentageUpper
           );

           const upperSurfacePercentage = interpolate(
               limitingDistance,
               lowerDistance,
               upperDistance,
               upperSurfacePercentageLower,
               upperSurfacePercentageUpper
           );

           // Interpolation finale entre les surfaces
           let finalPercentage;
           
           // Appliquer la formule pour les grandes surfaces si la distance est >= 1.2 m
           if (facadeSurface > surfacesToUse[surfacesToUse.length - 1] && limitingDistance >= 1.2) {
               if (usage === "groupes_A_B3_C_D_F3") {
                   finalPercentage = Math.pow(limitingDistance, 2);
               } else { // groupes_E_F1_F2
                   finalPercentage = 0.5 * Math.pow(limitingDistance, 2);
               }
               // Limiter √† 100%
               finalPercentage = Math.min(finalPercentage, 100);
           } else if (lowerSurface === upperSurface) {
               finalPercentage = lowerSurfacePercentage;
           } else {
               finalPercentage = interpolate(
                   facadeSurface,
                   lowerSurface,
                   upperSurface,
                   lowerSurfacePercentage,
                   upperSurfacePercentage
               );
           }
           
           // Appliquer la m√©thode de l'aire pond√©r√©e si demand√©e
           if (weightedArea) {
               let Te;
               if (resistanceAuFeu === "45") {
                   Te = 892;
               } else if (resistanceAuFeu === "60") {
                   Te = 927;
               } else { // 120
                   Te = 1010;
               }
               
               // Calculer le coefficient d'ouverture √©quivalente FEO
               const FEO = Math.pow((Tu / Te), 4);
               
               // Calculer la surface corrig√©e
               const AF = facadeSurface; // Surface ext√©rieure de la fa√ßade 
               const A = (finalPercentage / 100) * facadeSurface; // Surface r√©elle de baies non prot√©g√©es
               const AC = A + (AF - A) * FEO; // Surface corrig√©e
               
               // Recalculer le pourcentage
               finalPercentage = (AC / facadeSurface) * 100;
           }
           
           // Limiter le pourcentage entre 0 et 100
           finalPercentage = Math.max(0, Math.min(100, finalPercentage));
           
           // Majoration en cas de briques de verre / verre arm√©
           if (glassBrick) {
               finalPercentage = Math.min(100, finalPercentage * 2);
           }
           
           // Calculer la surface maximale
           const maxArea = (finalPercentage / 100) * facadeSurface;
           
           // D√©terminer les exigences de construction selon 3.2.3.7
           let constructionRequirements = determineConstructionRequirements(finalPercentage, usage, constructionType, revetementType);
           
           // V√©rification de l'espacement des baies
           let spacingResult = "";
           if (checkSpacing) {
               const minHorizontalSpacing = 2.0; // En m√®tres selon 3.2.3.1.(6)
               const minVerticalSpacing = 2.0;   // En m√®tres selon 3.2.3.1.(6)
               
               if (horizontalSpacing < minHorizontalSpacing || verticalSpacing < minVerticalSpacing) {
                   spacingResult = `
                       <br><strong>V√©rification de l'espacement des baies :</strong><br>
                       ‚ö†Ô∏è <span style="color: red;">NON CONFORME</span> - L'espacement des baies ne respecte pas les exigences minimales.<br>
                       Selon l'article 3.2.3.1.(6), l'espacement des baies non prot√©g√©es desservant une m√™me pi√®ce doit √™tre d'au moins :<br>
                       - 2 m horizontalement (valeur saisie: ${horizontalSpacing} m)<br>
                       - 2 m verticalement (valeur saisie: ${verticalSpacing} m)
                   `;
               } else {
                   spacingResult = `
                       <br><strong>V√©rification de l'espacement des baies :</strong><br>
                       ‚úÖ <span style="color: green;">CONFORME</span> - L'espacement des baies respecte les exigences minimales.<br>
                       Espacement horizontal: ${horizontalSpacing} m (minimum requis: 2 m)<br>
                       Espacement vertical: ${verticalSpacing} m (minimum requis: 2 m)
                   `;
               }
           }
           
           // V√©rification de la protection des soffites
           let soffitResult = "";
           if (checkSoffit) {
               if (soffit_distance < 0.45) {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       Selon l'article 3.2.3.6.(2), aucun soffite ne doit faire saillie au-dessus de la fa√ßade de rayonnement
                       lorsque la distance limitative est inf√©rieure √† 0,45 m.<br>
                       ${soffit_distance < 0.45 ? 
                           "‚ö†Ô∏è <span style=\"color: red;\">La distance du soffite (" + soffit_distance + " m) est inf√©rieure √† 0,45 m. Aucun soffite n'est autoris√©.</span>" : 
                           "La distance du soffite est conforme."}
                   `;
               } else if (soffit_distance < 1.2) {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       Selon l'article 3.2.3.6.(3-5), si la distance limitative est entre 0,45 m et 1,2 m, les soffites de toit 
                       ne doivent pas faire saillie √† moins de 0,45 m de la limite de propri√©t√©, ou doivent √™tre prot√©g√©s.<br>
                       ${soffit_distance < 0.45 ? 
                           "‚ö†Ô∏è <span style=\"color: red;\">La distance du soffite (" + soffit_distance + " m) est inf√©rieure √† 0,45 m. Une protection est requise.</span>" : 
                           "La distance du soffite est d'au moins 0,45 m."}
                       ${!soffit_protected && soffit_distance < 0.45 ? 
                           "<br>‚ö†Ô∏è <span style=\"color: red;\">Le soffite n'est pas prot√©g√© selon les exigences.</span>" : 
                           soffit_protected ? "<br>‚úÖ <span style=\"color: green;\">Le soffite est prot√©g√© selon les exigences.</span>" : ""}
                   `;
               } else {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       ‚úÖ <span style="color: green;">La distance du soffite (${soffit_distance} m) est sup√©rieure √† 1,2 m. 
                       Aucune protection sp√©cifique n'est requise.</span>
                   `;
               }
           }
           // Afficher les r√©sultats d√©taill√©s
           let resultHTML = `
               <strong>Donn√©es de calcul :</strong><br>
               ${response ? "Distance limitative ajust√©e : " + limitingDistance.toFixed(2) + " m<br>" : ""}
               Rapport L/H ou H/L : ${ratioCategory}<br>
               Type de construction : ${constructionType}<br>
               Type de rev√™tement : ${revetementType}<br>
               Protection par gicleurs : ${sprinklersOption === "complete" ? "Compl√®te" : sprinklersOption === "partial" ? "Partielle" : "Aucune"}<br>
               ${glassBrick ? "Majoration pour briques de verre/verre arm√© appliqu√©e (x2)<br>" : ""}
               ${weightedArea ? "M√©thode de l'aire pond√©r√©e appliqu√©e (Temp√©rature: " + Tu + "¬∞C, R√©sistance au feu: " + resistanceAuFeu + " min)<br>" : ""}
               <br><strong>D√©tails d'interpolation :</strong><br>
               Distance limitative entre ${lowerDistance} m et ${upperDistance} m<br>
               Surface de r√©f√©rence entre ${lowerSurface} m¬≤ et ${upperSurface} m¬≤<br>
               <br><strong>R√©sultats :</strong><br>
               Pourcentage maximal de baies non prot√©g√©es : ${finalPercentage.toFixed(2)}%<br>
               Surface maximale de baies non prot√©g√©es : ${maxArea.toFixed(2)} m¬≤
               ${constructionRequirements}
               ${spacingResult}
               ${soffitResult}
           `;

           // Ajouter la comparaison avec la surface propos√©e
           if (!isNaN(proposedArea) && proposedArea > 0) {
               const proposedPercentage = (proposedArea / facadeSurface) * 100;
               let statusClass = "";
               let comparisonResult = "";
               
               if (proposedPercentage > finalPercentage) {
                   statusClass = "color: red; font-weight: bold;";
                   comparisonResult = `
                       <br><br><strong>Comparaison avec la surface propos√©e:</strong><br>
                       Votre proposition: ${proposedArea.toFixed(2)} m¬≤ (${proposedPercentage.toFixed(2)}% de la fa√ßade)<br>
                       <span style="${statusClass}">‚ö†Ô∏è NON CONFORME: La surface propos√©e d√©passe le maximum autoris√© de ${maxArea.toFixed(2)} m¬≤ (${finalPercentage.toFixed(2)}%).</span>
                   `;
               } else {
                   statusClass = "color: green; font-weight: bold;";
                   comparisonResult = `
                       <br><br><strong>Comparaison avec la surface propos√©e:</strong><br>
                       Votre proposition: ${proposedArea.toFixed(2)} m¬≤ (${proposedPercentage.toFixed(2)}% de la fa√ßade)<br>
                       <span style="${statusClass}">‚úÖ CONFORME: La surface propos√©e respecte le maximum autoris√© de ${maxArea.toFixed(2)} m¬≤ (${finalPercentage.toFixed(2)}%).</span>
                   `;
               }
               
               // Ajouter le r√©sultat de comparaison √† resultHTML
               resultHTML += comparisonResult;
           }
           
           document.getElementById('cnb-result').innerHTML = resultHTML;
           document.getElementById('copy_cnb').style.display = 'inline-block';
       }
       
       function determineConstructionRequirements(percentage, usage, constructionType, revetementType) {
           // D√©terminer le degr√© de r√©sistance au feu et les exigences de construction selon 3.2.3.7
           let degre = "";
           let constructionExigence = "";
           let revetementExigence = "";
           
           if (percentage <= 10) {
               if (usage === "groupes_A_B3_C_D_F3") {
                   degre = "1 h";
               } else { // groupes_E_F1_F2
                   degre = "2 h";
               }
               constructionExigence = "Incombustible";
               revetementExigence = "Incombustible";
           } else if (percentage <= 25) {
               if (usage === "groupes_A_B3_C_D_F3") {
                   degre = "1 h";
               } else { // groupes_E_F1_F2
                   degre = "2 h";
               }
               constructionExigence = "Combustible ou incombustible";
               revetementExigence = "Incombustible";
           } else if (percentage <= 50) {
               if (usage === "groupes_A_B3_C_D_F3") {
                   degre = "45 min";
               } else { // groupes_E_F1_F2
                   degre = "1 h";
               }
               constructionExigence = "Combustible ou incombustible";
               revetementExigence = "Incombustible";
           } else if (percentage < 100) {
               if (usage === "groupes_A_B3_C_D_F3") {
                   degre = "45 min";
               } else { // groupes_E_F1_F2
                   degre = "1 h";
               }
               constructionExigence = "Combustible ou incombustible";
               revetementExigence = "Combustible ou incombustible";
           }
// Si la construction actuelle n'est pas conforme, ajouter un avertissement
           let warningMsg = "";
           if ((constructionExigence === "Incombustible" && constructionType === "combustible") ||
               (revetementExigence === "Incombustible" && revetementType === "combustible")) {
               warningMsg = "<br>‚ö†Ô∏è <strong>Attention :</strong> La construction ou le rev√™tement s√©lectionn√© ne respecte pas les exigences minimales du tableau 3.2.3.7.";
           }
           
           return `
               <br><strong>Exigences de construction (tableau 3.2.3.7):</strong><br>
               Pour ${percentage.toFixed(2)}% de baies non prot√©g√©es:<br>
               - Degr√© de r√©sistance au feu minimal: ${degre}<br>
               - Type de construction exig√©: ${constructionExigence}<br>
               - Type de rev√™tement exig√©: ${revetementExigence}${warningMsg}
           `;
       }

       // Donn√©es du Tableau 9.10.14.4-A
       const tableau91014 = {
           "habitation": {
               surfaces: {
                   30: [0, 7, 9, 12, 39, 88, 100, 100, 100, 100, 100, 100, 100],
                   40: [0, 7, 8, 11, 32, 69, 100, 100, 100, 100, 100, 100, 100],
                   50: [0, 7, 8, 10, 28, 57, 100, 100, 100, 100, 100, 100, 100],
                   100: [0, 7, 8, 9, 18, 34, 56, 84, 100, 100, 100, 100, 100],
                  ">100": [0, 7, 7, 8, 12, 19, 28, 40, 55, 92, 100, 100, 100]
              },
              distances: [0, 1.2, 1.5, 2.0, 4.0, 6.0, 8.0, 10.0, 12.0, 16.0, 20.0, 25.0, 30.0]
          },
          "commercial": {
              surfaces: {
                  30: [0, 4, 4, 6, 20, 44, 80, 100, 100, 100, 100, 100, 100],
                  40: [0, 4, 4, 6, 16, 34, 61, 97, 100, 100, 100, 100, 100],
                  50: [0, 4, 4, 5, 14, 29, 50, 79, 100, 100, 100, 100, 100],
                  100: [0, 4, 4, 4, 9, 17, 28, 42, 60, 100, 100, 100, 100],
                  ">100": [0, 4, 4, 4, 6, 10, 14, 20, 27, 46, 70, 100, 100]
              },
              distances: [0, 1.2, 1.5, 2.0, 4.0, 6.0, 8.0, 10.0, 12.0, 16.0, 20.0, 25.0, 30.0]
          }
      };
          function calculate91014() {
          const usage = document.getElementById('usage_91014').value;
          const buildingType = document.getElementById('building_type_91014').value;
          const exteriorFinish = document.getElementById('exterior_finish_91014').value;
          const sprinklersOption = document.getElementById('sprinklers_91014').value;
          const glassBrick = document.getElementById('glass_brick_91014').checked;
          let limitingDistance = parseFloat(document.getElementById('distance_91014').value);
          const surface = parseFloat(document.getElementById('surface_91014').value);
          const response = document.getElementById('response_91014').checked;
          const proposedArea = parseFloat(document.getElementById('proposed_area_91014').value);
          const checkSpacing = document.getElementById('check_spacing_91014').checked;
          const horizontalSpacing = parseFloat(document.getElementById('horizontal_spacing_91014').value);
          const verticalSpacing = parseFloat(document.getElementById('vertical_spacing_91014').value);
          const checkSoffit = document.getElementById('check_soffit_91014').checked;
          const soffit_distance = parseFloat(document.getElementById('soffit_distance_91014').value);
          const soffit_protected = document.getElementById('soffit_protected_91014').checked;
          const distinction = document.getElementById('distinction_91014').value;

          // V√©rification des entr√©es
          if (isNaN(limitingDistance) || isNaN(surface) || limitingDistance < 0 || surface <= 0) {
              document.getElementById('method91014-result').innerHTML = "Erreur : Veuillez entrer des valeurs num√©riques valides.";
              return;
          }

          // Ajustement pour le d√©lai d'intervention
          if (response) {
              limitingDistance = limitingDistance / 2;
          }
          
          // Exemption pour les garages ou b√¢timents secondaires
          if (buildingType === "garage") {
              // Selon 9.10.14.4.(10-12), les baies vitr√©es des garages peuvent √™tre exempt√©es des restrictions
               document.getElementById('method91014-result').innerHTML = `
                   <strong>R√©sultat pour garage ou b√¢timent secondaire :</strong><br>
                   Selon les paragraphes 9.10.14.4.(10-12) et 9.10.14.5.(4-5), les garages et b√¢timents secondaires 
                   qui ne desservent qu'un seul logement peuvent b√©n√©ficier d'exemptions importantes:<br><br>
                   
                   - Si le garage dessert un seul logement et est sur la m√™me propri√©t√©: 
                     <strong>pas de limite de surface pour les baies vitr√©es</strong><br>
                   - Pour la construction de la fa√ßade de rayonnement, si la distance limitative est d'au moins 0,6 m:
                     <strong>pas d'exigence quant au degr√© de r√©sistance au feu</strong><br>
                   - Si la distance limitative est inf√©rieure √† 0,6 m: <strong>un degr√© de r√©sistance au feu d'au moins 
                     45 min est requis</strong><br>
                   - <strong>Aucune exigence quant au type de rev√™tement</strong>, peu importe la distance limitative<br><br>
                   
                   Pour une analyse plus sp√©cifique, veuillez s√©lectionner "B√¢timent standard" dans le type de b√¢timent.
               `;
               document.getElementById('copy_91014').style.display = 'inline-block';
               return;
           }

           const distances = tableau91014[usage].distances;
           
           // Si la distance limitative d√©passe la plage du tableau
           if (limitingDistance > distances[distances.length - 1]) {
               const resultHTML = `
                   <strong>Distance limitative (${limitingDistance.toFixed(2)} m) sup√©rieure aux valeurs du tableau.</strong><br>
                   Surface maximale des baies non prot√©g√©es : 100% (${surface.toFixed(2)} m¬≤)
               `;
               document.getElementById('method91014-result').innerHTML = resultHTML;
               document.getElementById('copy_91014').style.display = 'inline-block';
               return;
           }

           // Trouver les bornes pour l'interpolation de distance
           const { lower: lowerDistance, upper: upperDistance } = findBounds(limitingDistance, distances);
           const lowerDistanceIndex = distances.indexOf(lowerDistance);
           const upperDistanceIndex = distances.indexOf(upperDistance);

           // D√©finir les surfaces connues du tableau pour l'interpolation
           const surfaceValues = [30, 40, 50, 100];
           
           // Trouver les surfaces les plus proches pour l'interpolation
           let lowerSurface, upperSurface;
           
           if (surface <= 30) {
               lowerSurface = 30;
               upperSurface = 40;
           } else if (surface <= 40) {
               lowerSurface = 30;
               upperSurface = 40;
           } else if (surface <= 50) {
               lowerSurface = 40;
               upperSurface = 50;
           } else if (surface <= 100) {
               lowerSurface = 50;
               upperSurface = 100;
           } else {
               lowerSurface = 100;
               upperSurface = ">100";
           }
           
           // Calculer le pourcentage pour la surface inf√©rieure
           const lowerSurfacePercentageLower = tableau91014[usage].surfaces[lowerSurface][lowerDistanceIndex];
           const lowerSurfacePercentageUpper = tableau91014[usage].surfaces[lowerSurface][upperDistanceIndex];
           const lowerSurfacePercentage = interpolate(
               limitingDistance, 
               lowerDistance, 
               upperDistance, 
               lowerSurfacePercentageLower, 
               lowerSurfacePercentageUpper
           );
           
           // Calculer le pourcentage pour la surface sup√©rieure
           const upperSurfacePercentageLower = tableau91014[usage].surfaces[upperSurface === ">100" ? ">100" : upperSurface][lowerDistanceIndex];
           const upperSurfacePercentageUpper = tableau91014[usage].surfaces[upperSurface === ">100" ? ">100" : upperSurface][upperDistanceIndex];
           const upperSurfacePercentage = interpolate(
               limitingDistance, 
               lowerDistance, 
               upperDistance, 
               upperSurfacePercentageLower, 
               upperSurfacePercentageUpper
           );
           
           // Interpolation finale entre les surfaces
           let finalPercentage;
           
           // Appliquer la formule pour les grandes surfaces si la distance est >= 1.2 m
           if (surface > 100 && limitingDistance >= 1.2) {
               if (usage === "habitation") {
                   finalPercentage = Math.pow(limitingDistance, 2);
               } else { // commercial
                   finalPercentage = 0.5 * Math.pow(limitingDistance, 2);
               }
               // Limiter √† 100%
               finalPercentage = Math.min(finalPercentage, 100);
           } else if (lowerSurface === upperSurface || upperSurface === ">100") {
               finalPercentage = lowerSurfacePercentage;
           } else {
               finalPercentage = interpolate(
                   surface, 
                   lowerSurface, 
                   upperSurface, 
                   lowerSurfacePercentage, 
                   upperSurfacePercentage
               );
           }
           
           // Majoration pour gicleurs ou verre arm√©/briques de verre
           if (sprinklersOption === "complete") {
               finalPercentage = Math.min(100, finalPercentage * 2);
           } else if (glassBrick) {
               finalPercentage = Math.min(100, finalPercentage * 2);
           }
           
           // Limiter le pourcentage entre 0 et 100
           finalPercentage = Math.max(0, Math.min(100, finalPercentage));
           
           // Calculer la surface maximale
           const maxArea = (finalPercentage / 100) * surface;
           
           // D√©terminer les exigences de construction et de protection
           let constructionRequirements = "";
           
           if (limitingDistance < 1.2) {
               constructionRequirements = `
                   <br><strong>Exigences pour distance limitative < 1,2 m (9.10.14.4.2):</strong><br>
                   - Les ouvertures doivent √™tre prot√©g√©es par des dispositifs d'obturation<br>
                   - Le verre arm√© et les briques de verre ne sont pas autoris√©s<br>
                   - ${exteriorFinish === "incombustible" ? 
                       "Rev√™tement incombustible requis pour les fa√ßades" : 
                       "Rev√™tement combustible soumis √† des restrictions importantes (voir 9.10.14.5)"}
               `;
           }
           
           // V√©rification de l'espacement des baies
           let spacingResult = "";
           if (checkSpacing) {
               const minHorizontalSpacing = 2.0; // En m√®tres selon 9.10.14.4.(4)
               const minVerticalSpacing = 2.0;   // En m√®tres selon 9.10.14.4.(4)
               
               if (horizontalSpacing < minHorizontalSpacing || verticalSpacing < minVerticalSpacing) {
                   spacingResult = `
                       <br><strong>V√©rification de l'espacement des baies :</strong><br>
                       ‚ö†Ô∏è <span style="color: red;">NON CONFORME</span> - L'espacement des baies ne respecte pas les exigences minimales.<br>
                       Selon l'article 9.10.14.4.(4), l'espacement des baies non prot√©g√©es desservant une m√™me pi√®ce doit √™tre d'au moins :<br>
                       - 2 m horizontalement (valeur saisie: ${horizontalSpacing} m)<br>
                       - 2 m verticalement (valeur saisie: ${verticalSpacing} m)
                   `;
               } else {
                   spacingResult = `
                       <br><strong>V√©rification de l'espacement des baies :</strong><br>
                       ‚úÖ <span style="color: green;">CONFORME</span> - L'espacement des baies respecte les exigences minimales.<br>
                       Espacement horizontal: ${horizontalSpacing} m (minimum requis: 2 m)<br>
                       Espacement vertical: ${verticalSpacing} m (minimum requis: 2 m)
                   `;
               }
           }
           
           // V√©rification de la protection des soffites
           let soffitResult = "";
           if (checkSoffit) {
               if (soffit_distance < 0.45) {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       Selon l'article 9.10.14.5.(9), aucun soffite ne doit faire saillie au-dessus de la fa√ßade de rayonnement
                       lorsque la distance limitative est inf√©rieure √† 0,45 m.<br>
                       ${soffit_distance < 0.45 ? 
                           "‚ö†Ô∏è <span style=\"color: red;\">La distance du soffite (" + soffit_distance + " m) est inf√©rieure √† 0,45 m. Aucun soffite n'est autoris√©.</span>" : 
                           "La distance du soffite est conforme."}
                   `;
               } else if (soffit_distance < 1.2) {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       Selon l'article 9.10.14.5.(10-12), si la distance limitative est entre 0,45 m et 1,2 m, les soffites de toit 
                       ne doivent pas faire saillie √† moins de 0,45 m de la limite de propri√©t√©, ou doivent √™tre prot√©g√©s.<br>
                       ${soffit_distance < 0.45 ? 
                           "‚ö†Ô∏è <span style=\"color: red;\">La distance du soffite (" + soffit_distance + " m) est inf√©rieure √† 0,45 m. Une protection est requise.</span>" : 
                           "La distance du soffite est d'au moins 0,45 m."}
                       ${!soffit_protected && soffit_distance < 1.2 ? 
                           "<br>‚ö†Ô∏è <span style=\"color: red;\">Le soffite n'est pas prot√©g√© selon les exigences.</span>" : 
                           soffit_protected ? "<br>‚úÖ <span style=\"color: green;\">Le soffite est prot√©g√© selon les exigences.</span>" : ""}
                   `;
               } else {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       ‚úÖ <span style="color: green;">La distance du soffite (${soffit_distance} m) est sup√©rieure √† 1,2 m. 
                       Aucune protection sp√©cifique n'est requise.</span>
                   `;
               }
           }
           
           // Distinction entre baies vitr√©es et baies non prot√©g√©es
           let distinctionInfo = "";
           if (distinction === "glazed") {
               distinctionInfo = `
                   <br><strong>Type de baies :</strong><br>
                   <i>Vous avez sp√©cifi√© des baies vitr√©es. En vertu de 9.10.14, les baies vitr√©es sont une cat√©gorie 
                   sp√©cifique de baies non prot√©g√©es. Les baies vitr√©es sont soumises aux m√™mes restrictions de 
                   surface que les baies non prot√©g√©es, mais peuvent avoir des exigences diff√©rentes en mati√®re de 
                   construction et de protection.</i>
               `;
           }

           // Afficher les r√©sultats avec d√©tails des calculs interm√©diaires
           let resultHTML = `
               <strong>Donn√©es de calcul :</strong><br>
               ${response ? "Distance limitative ajust√©e : " + limitingDistance.toFixed(2) + " m<br>" : ""}
               Type d'usage : ${usage === "habitation" ? "Habitation, √©tablissement d'affaires et √©tablissement industriel √† risques faibles" : "√âtablissement commercial et √©tablissement industriel √† risques moyens"}<br>
               Surface totale de la fa√ßade : ${surface.toFixed(2)} m¬≤<br>
               Protection par gicleurs : ${sprinklersOption === "complete" ? "Compl√®te" : sprinklersOption === "partial" ? "Partielle" : "Aucune"}<br>
               ${glassBrick ? "Majoration pour briques de verre/verre arm√© appliqu√©e (x2)<br>" : ""}
               <br><strong>D√©tails d'interpolation :</strong><br>
               Distance limitative entre ${lowerDistance} m et ${upperDistance} m<br>
               Surface de r√©f√©rence entre ${lowerSurface === upperSurface ? lowerSurface : lowerSurface + " m¬≤ et " + upperSurface + " m¬≤"}<br>
               <br><strong>R√©sultats :</strong><br>
               Pourcentage maximal de baies non prot√©g√©es : ${finalPercentage.toFixed(2)}%<br>
               Surface maximale de baies non prot√©g√©es : ${maxArea.toFixed(2)} m¬≤
               ${constructionRequirements}
               ${spacingResult}
               ${soffitResult}
               ${distinctionInfo}
           `;
           
           // Ajouter la comparaison avec la surface propos√©e si existe
           if (!isNaN(proposedArea) && proposedArea > 0) {
               const proposedPercentage = (proposedArea / surface) * 100;
               let statusClass = "";
               let comparisonResult = "";
               
               if (proposedPercentage > finalPercentage) {
                   statusClass = "color: red; font-weight: bold;";
                   comparisonResult = `
                       <br><br><strong>Comparaison avec la surface propos√©e:</strong><br>
                       Votre proposition: ${proposedArea.toFixed(2)} m¬≤ (${proposedPercentage.toFixed(2)}% de la fa√ßade)<br>
                       <span style="${statusClass}">‚ö†Ô∏è NON CONFORME: La surface propos√©e d√©passe le maximum autoris√© de ${maxArea.toFixed(2)} m¬≤ (${finalPercentage.toFixed(2)}%).</span>
                   `;
               } else {
                   statusClass = "color: green; font-weight: bold;";
                   comparisonResult = `
                       <br><br><strong>Comparaison avec la surface propos√©e:</strong><br>
                       Votre proposition: ${proposedArea.toFixed(2)} m¬≤ (${proposedPercentage.toFixed(2)}% de la fa√ßade)<br>
                       <span style="${statusClass}">‚úÖ CONFORME: La surface propos√©e respecte le maximum autoris√© de ${maxArea.toFixed(2)} m¬≤ (${finalPercentage.toFixed(2)}%).</span>
                   `;
               }
               
               // Ajouter le r√©sultat de comparaison √† resultHTML
               resultHTML += comparisonResult;
           }
           
           document.getElementById('method91014-result').innerHTML = resultHTML;
           document.getElementById('copy_91014').style.display = 'inline-block';
       }

       // Donn√©es du Tableau 9.10.15.4
       const tableau91015 = {
           surfaces: {
               30: [0, 7, 9, 12, 39, 88, 100, 100, 100, 100, 100],
               40: [0, 7, 8, 11, 32, 69, 100, 100, 100, 100, 100],
               50: [0, 7, 8, 10, 28, 57, 100, 100, 100, 100, 100],
               100: [0, 7, 8, 9, 18, 34, 56, 84, 100, 100, 100],
               ">100": [0, 7, 7, 8, 12, 19, 28, 40, 55, 92, 100]
           },
           distances: [0, 1.2, 1.5, 2.0, 4.0, 6.0, 8.0, 10.0, 12.0, 16.0, 20.0]
       };
       
       function calculate91015() {
           let limitingDistance = parseFloat(document.getElementById('distance_91015').value);
           const surface = parseFloat(document.getElementById('surface_91015').value);
           const response = document.getElementById('response_91015').checked;
           const housingType = document.getElementById('housing_type_91015').value;
           const revetingType = document.getElementById('reveting_type_91015').value;
           const sprinklersOption = document.getElementById('sprinklers_91015').value;
           const glassBrick = document.getElementById('glass_brick_91015').checked;
           const proposedArea = parseFloat(document.getElementById('proposed_area_91015').value);
           const checkSpacing = document.getElementById('check_spacing_91015').checked;
           const horizontalSpacing = parseFloat(document.getElementById('horizontal_spacing_91015').value);
           const verticalSpacing = parseFloat(document.getElementById('vertical_spacing_91015').value);
           const checkSoffit = document.getElementById('check_soffit_91015').checked;
           const soffit_distance = parseFloat(document.getElementById('soffit_distance_91015').value);
           const soffit_protected = document.getElementById('soffit_protected_91015').checked;
           const distinction = document.getElementById('distinction_91015').value;

           // V√©rification des entr√©es
           if (isNaN(limitingDistance) || isNaN(surface) || limitingDistance < 0 || surface <= 0) {
               document.getElementById('method91015-result').innerHTML = "Erreur : Veuillez entrer des valeurs num√©riques valides.";
               return;
           }

           // Ajustement pour le d√©lai d'intervention
           if (response) {
               limitingDistance = limitingDistance / 2;
           }

           const distances = tableau91015.distances;
           
           // Si la distance limitative d√©passe la plage du tableau
           if (limitingDistance > distances[distances.length - 1]) {
               const resultHTML = `
                   <strong>Distance limitative (${limitingDistance.toFixed(2)} m) sup√©rieure aux valeurs du tableau.</strong><br>
                   Surface maximale des baies non prot√©g√©es : 100% (${surface.toFixed(2)} m¬≤)
               `;
               document.getElementById('method91015-result').innerHTML = resultHTML;
               document.getElementById('copy_91015').style.display = 'inline-block';
               return;
           }

           // Trouver les bornes pour l'interpolation de distance
           const { lower: lowerDistance, upper: upperDistance } = findBounds(limitingDistance, distances);
           const lowerDistanceIndex = distances.indexOf(lowerDistance);
           const upperDistanceIndex = distances.indexOf(upperDistance);

           // D√©finir les surfaces connues du tableau pour l'interpolation
           const surfaceValues = [30, 40, 50, 100];
           
           // Trouver les surfaces les plus proches pour l'interpolation
           let lowerSurface, upperSurface;
           
           if (surface <= 30) {
               lowerSurface = 30;
               upperSurface = 40;
           } else if (surface <= 40) {
               lowerSurface = 30;
               upperSurface = 40;
           } else if (surface <= 50) {
               lowerSurface = 40;
               upperSurface = 50;
           } else if (surface <= 100) {
               lowerSurface = 50;
               upperSurface = 100;
           } else {
               lowerSurface = 100;
               upperSurface = ">100";
           }
           
           // Calculer le pourcentage pour la surface inf√©rieure
           const lowerSurfacePercentageLower = tableau91015.surfaces[lowerSurface][lowerDistanceIndex];
           const lowerSurfacePercentageUpper = tableau91015.surfaces[lowerSurface][upperDistanceIndex];
           const lowerSurfacePercentage = interpolate(
               limitingDistance, 
               lowerDistance, 
               upperDistance, 
               lowerSurfacePercentageLower, 
               lowerSurfacePercentageUpper
           );
           
           // Calculer le pourcentage pour la surface sup√©rieure
           const upperSurfacePercentageLower = tableau91015.surfaces[upperSurface === ">100" ? ">100" : upperSurface][lowerDistanceIndex];
           const upperSurfacePercentageUpper = tableau91015.surfaces[upperSurface === ">100" ? ">100" : upperSurface][upperDistanceIndex];
           const upperSurfacePercentage = interpolate(
               limitingDistance, 
               lowerDistance, 
               upperDistance, 
               upperSurfacePercentageLower, 
               upperSurfacePercentageUpper
           );
           
           // Interpolation finale entre les surfaces
           let finalPercentage;
           
           // Appliquer la formule pour les grandes surfaces si la distance est >= 1.2 m
           if (surface > 100 && limitingDistance >= 1.2) {
               finalPercentage = Math.pow(limitingDistance, 2);
               // Limiter √† 100%
               finalPercentage = Math.min(finalPercentage, 100);
           } else if (lowerSurface === upperSurface || upperSurface === ">100") {
               finalPercentage = lowerSurfacePercentage;
           } else {
               finalPercentage = interpolate(
                   surface, 
                   lowerSurface, 
                   upperSurface, 
                   lowerSurfacePercentage, 
                   upperSurfacePercentage
               );
           }
           
           // Majoration pour gicleurs ou verre arm√©/briques de verre
           if (sprinklersOption === "complete") {
               finalPercentage = Math.min(100, finalPercentage * 2);
           } else if (glassBrick) {
               finalPercentage = Math.min(100, finalPercentage * 2);
           }
           
           // Limiter le pourcentage entre 0 et 100
           finalPercentage = Math.max(0, Math.min(100, finalPercentage));
           
           // Calculer la surface maximale
           const maxArea = (finalPercentage / 100) * surface;
           
           // D√©terminer les exigences de construction
           let constructionRequirements = "";
           if (limitingDistance < 0.6) {
               constructionRequirements = `
                   <br><strong>Exigences de construction (selon 9.10.15.5):</strong><br>
                   - Degr√© de r√©sistance au feu d'au moins 45 min pour la fa√ßade de rayonnement<br>
                   - Rev√™tement ext√©rieur ${revetingType === "incombustible" ? "incombustible" : "combustible avec contraintes"}<br>
                   ${revetingType === "combustible" ? 
                   `- Le rev√™tement combustible doit √™tre install√© selon l'article 9.10.15.5, paragraphe 2):<br>
                      &nbsp;&nbsp;‚Ä¢ Pos√© sur rev√™tement en plaques de pl√¢tre d'au moins 12,7 mm ou ma√ßonnerie<br>
                      &nbsp;&nbsp;‚Ä¢ Doit avoir un indice de propagation de la flamme d'au plus 25<br>
                      &nbsp;&nbsp;‚Ä¢ Si c'est un rev√™tement conforme √† 9.27.12, son √©paisseur ne doit pas d√©passer 2 mm<br>
                      &nbsp;&nbsp;‚Ä¢ Peut aussi √™tre conforme √† l'alin√©a 3.1.5.5.1)b)`
                    : ""}
           `;
           } else if (limitingDistance < 1.2) {
               constructionRequirements = `
                   <br><strong>Exigences de construction (selon 9.10.15.5):</strong><br>
                   - Degr√© de r√©sistance au feu d'au moins 45 min pour la fa√ßade de rayonnement<br>
                   ${revetingType === "combustible" ? 
                   `- Rev√™tement combustible soumis aux exigences du paragraphe 3) de l'article 9.10.15.5:<br>
                      &nbsp;&nbsp;‚Ä¢ Si conforme √† 9.27.6, 9.27.7, 9.27.8, 9.27.9 ou 9.27.10:<br>
                      &nbsp;&nbsp;&nbsp;&nbsp;- Pos√© sur rev√™tement en plaques de pl√¢tre d'au moins 12,7 mm ou ma√ßonnerie<br>
                      &nbsp;&nbsp;&nbsp;&nbsp;- Doit avoir un indice de propagation de la flamme d'au plus 25 apr√®s conditionnement<br>
                      &nbsp;&nbsp;‚Ä¢ Si conforme √† 9.27.12:<br>
                      &nbsp;&nbsp;&nbsp;&nbsp;- Pos√© sur rev√™tement en plaques de pl√¢tre d'au moins 12,7 mm ou ma√ßonnerie<br>
                      &nbsp;&nbsp;&nbsp;&nbsp;- Doit avoir un indice de propagation de la flamme d'au plus 25<br>
                      &nbsp;&nbsp;&nbsp;&nbsp;- Ne doit pas d√©passer 2 mm d'√©paisseur<br>
                      &nbsp;&nbsp;‚Ä¢ Peut aussi √™tre conforme √† l'alin√©a 3.1.5.5.1)b)`
                    : "- Rev√™tement incombustible selon la section 9.20, la sous-section 9.27.11 ou la section 9.28"}
               `;
           } else {
               constructionRequirements = `
                   <br><strong>Exigences de construction (selon 9.10.15.5):</strong><br>
                   - Pour distance limitative ‚â• 1,2 m: les restrictions sont moins s√©v√®res<br>
                   - Les exigences minimales pour les soffites s'appliquent quand ils font saillie √† moins de 1,2 m de la limite de propri√©t√©<br>
                   - Pour les poteaux en gros bois d'≈ìuvre: pas de conformit√© n√©cessaire si distance ‚â• 3 m
               `;
           }
           
           // V√©rification de l'espacement des baies
           let spacingResult = "";
           if (checkSpacing) {
               const minHorizontalSpacing = 2.0; // En m√®tres selon 9.10.15.4.(4)
               const minVerticalSpacing = 2.0;   // En m√®tres selon 9.10.15.4.(4)
               
               if (horizontalSpacing < minHorizontalSpacing || verticalSpacing < minVerticalSpacing) {
                   spacingResult = `
                       <br><strong>V√©rification de l'espacement des baies :</strong><br>
                       ‚ö†Ô∏è <span style="color: red;">NON CONFORME</span> - L'espacement des baies ne respecte pas les exigences minimales.<br>
                       Selon l'article 9.10.15.4.(4), l'espacement des baies vitr√©es desservant une m√™me pi√®ce doit √™tre d'au moins :<br>
                       - 2 m horizontalement (valeur saisie: ${horizontalSpacing} m)<br>
                       - 2 m verticalement (valeur saisie: ${verticalSpacing} m)
                   `;
               } else {
                   spacingResult = `
                       <br><strong>V√©rification de l'espacement des baies :</strong><br>
                       ‚úÖ <span style="color: green;">CONFORME</span> - L'espacement des baies respecte les exigences minimales.<br>
                       Espacement horizontal: ${horizontalSpacing} m (minimum requis: 2 m)<br>
                       Espacement vertical: ${verticalSpacing} m (minimum requis: 2 m)
                   `;
               }
           }
           
           // V√©rification de la protection des soffites
           let soffitResult = "";
           if (checkSoffit) {
               if (soffit_distance < 0.45) {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       Selon l'article 9.10.15.5.(8), aucun soffite ne doit faire saillie au-dessus de la fa√ßade de rayonnement
                       lorsque la distance limitative est inf√©rieure √† 0,45 m.<br>
                       ${soffit_distance < 0.45 ? 
                           "‚ö†Ô∏è <span style=\"color: red;\">La distance du soffite (" + soffit_distance + " m) est inf√©rieure √† 0,45 m. Aucun soffite n'est autoris√©.</span>" : 
                           "La distance du soffite est conforme."}
                   `;
               } else if (soffit_distance < 1.2) {
                   soffitResult = `
                       <br><strong>Protection des soffites :</strong><br>
                       Selon l'article 9.10.15.5.(9-11), si la distance limitative est entre 0,45 m et 1,2 m, les soffites de toit 
                       ne doivent pas faire saillie √† moins de 0,45 m de la limite de propri√©t√©, ou doivent √™tre prot√©g√©s.<br>
                       ${soffit_distance < 0.45 ? 
                           "‚ö†Ô∏è <span style=\"color: red;\">La distance du soffite (" + soffit_distance + " m) est inf√©rieure √† 0,45 m. Une protection est requise.</span>" : 
                           "La distance du soffite est d'au moins 0,45 m."}
                       ${!soffit_protected && soffit_distance < 1.2 ? 
                           "<br>‚ö†Ô∏è <span style=\"color: red;\">Le soffite n'est pas prot√©g√© selon les exigences.</span>" : 
                           soffit_protected ? "<br>‚úÖ <span style=\"color: green;\">Le soffite est prot√©g√© selon les exigences.</span>" : ""}
                   `;
               } else {
                   soffitResult = `
                      <br><strong>Protection des soffites :</strong><br>
                      ‚úÖ <span style="color: green;">La distance du soffite (${soffit_distance} m) est sup√©rieure √† 1,2 m. 
                      Aucune protection sp√©cifique n'est requise.</span>
                  `;
              }
          }
          
          // Ajouter des informations sp√©cifiques au type d'habitation
          let housingInfo = "";
          if (housingType === "accessoire") {
              housingInfo = `
                  <br><strong>Remarque pour logement accessoire:</strong><br>
                  - Les maisons comportant un logement accessoire peuvent avoir des exigences suppl√©mentaires.<br>
                  - V√©rifier √©galement les exigences de l'article 9.10.15.5 pour les rev√™tements.<br>
              `;
          }
          
          // Distinction entre baies vitr√©es et baies non prot√©g√©es
          let distinctionInfo = "";
          if (distinction === "glazed") {
              distinctionInfo = `
                  <br><strong>Type de baies :</strong><br>
                  <i>Vous avez sp√©cifi√© des baies vitr√©es. La sous-section 9.10.15 fait sp√©cifiquement r√©f√©rence 
                  aux baies vitr√©es, qui sont une cat√©gorie de baies non prot√©g√©es. La distinction est importante 
                  car certaines exigences peuvent varier.</i>
              `;
          }

          // Afficher les r√©sultats avec d√©tails des calculs interm√©diaires
          let resultHTML = `
              <strong>Donn√©es de calcul :</strong><br>
              ${response ? "Distance limitative ajust√©e : " + limitingDistance.toFixed(2) + " m<br>" : ""}
              Surface totale de la fa√ßade : ${surface.toFixed(2)} m¬≤<br>
              Type d'habitation : ${housingType === "standard" ? "Habitation standard" : "Maison comportant un logement accessoire"}<br>
              Type de rev√™tement : ${revetingType === "combustible" ? "Combustible" : "Incombustible"}<br>
              Protection par gicleurs : ${sprinklersOption === "complete" ? "Compl√®te" : sprinklersOption === "partial" ? "Partielle" : "Aucune"}<br>
              ${glassBrick ? "Majoration pour briques de verre/verre arm√© appliqu√©e (x2)<br>" : ""}
              <br><strong>D√©tails d'interpolation :</strong><br>
              Distance limitative entre ${lowerDistance} m et ${upperDistance} m<br>
              Surface de r√©f√©rence entre ${lowerSurface === upperSurface ? lowerSurface : lowerSurface + " m¬≤ et " + upperSurface + " m¬≤"}<br>
              <br><strong>R√©sultats :</strong><br>
              Pourcentage maximal de baies non prot√©g√©es : ${finalPercentage.toFixed(2)}%<br>
              Surface maximale de baies non prot√©g√©es : ${maxArea.toFixed(2)} m¬≤
              ${constructionRequirements}
              ${spacingResult}
              ${soffitResult}
              ${housingInfo}
              ${distinctionInfo}
          `;

          // Ajouter la comparaison avec la surface propos√©e si existe
          if (!isNaN(proposedArea) && proposedArea > 0) {
              const proposedPercentage = (proposedArea / surface) * 100;
              let statusClass = "";
              let comparisonResult = "";
              
              if (proposedPercentage > finalPercentage) {
                  statusClass = "color: red; font-weight: bold;";
                  comparisonResult = `
                      <br><br><strong>Comparaison avec la surface propos√©e:</strong><br>
                      Votre proposition: ${proposedArea.toFixed(2)} m¬≤ (${proposedPercentage.toFixed(2)}% de la fa√ßade)<br>
                      <span style="${statusClass}">‚ö†Ô∏è NON CONFORME: La surface propos√©e d√©passe le maximum autoris√© de ${maxArea.toFixed(2)} m¬≤ (${finalPercentage.toFixed(2)}%).</span>
                  `;
              } else {
                  statusClass = "color: green; font-weight: bold;";
                  comparisonResult = `
                      <br><br><strong>Comparaison avec la surface propos√©e:</strong><br>
                      Votre proposition: ${proposedArea.toFixed(2)} m¬≤ (${proposedPercentage.toFixed(2)}% de la fa√ßade)<br>
                      <span style="${statusClass}">‚úÖ CONFORME: La surface propos√©e respecte le maximum autoris√© de ${maxArea.toFixed(2)} m¬≤ (${finalPercentage.toFixed(2)}%).</span>
                  `;
              }
              
              // Ajouter le r√©sultat de comparaison √† resultHTML
              resultHTML += comparisonResult;
          }
          
          document.getElementById('method91015-result').innerHTML = resultHTML;
          document.getElementById('copy_91015').style.display = 'inline-block';
      }

      function openTab(event, tabName) {
          var tabcontent = document.getElementsByClassName("tab-content");
          for (var i = 0; i < tabcontent.length; i++) {
              tabcontent[i].classList.remove("active");
          }
          var tablinks = document.getElementsByClassName("tab-link");
          for (var i = 0; i < tablinks.length; i++) {
              tablinks[i].classList.remove("active");
          }
          document.getElementById(tabName).classList.add("active");
          event.currentTarget.classList.add("active");
      }

      // Fonction pour copier le contenu dans le presse-papier
      function copyToClipboard(elementId) {
          const element = document.getElementById(elementId);
          const text = element.innerText;
          
          navigator.clipboard.writeText(text)
              .then(() => {
                  // Feedback visuel temporaire
                  const originalButtonText = document.getElementById(`copy_${elementId.split('-')[0]}`).innerHTML;
                  document.getElementById(`copy_${elementId.split('-')[0]}`).innerHTML = "‚úì Copi√©!";
                  setTimeout(() => {
                      document.getElementById(`copy_${elementId.split('-')[0]}`).innerHTML = originalButtonText;
                  }, 2000);
              })
              .catch(err => {
                  console.error('Impossible de copier le texte:', err);
                  alert('Impossible de copier le texte. Veuillez r√©essayer ou copier manuellement.');
              });
      }

      // Fonction pour g√©rer l'appui sur la touche Enter
      function handleEnterKey(event, calculationFunction) {
          if (event.key === "Enter") {
              calculationFunction();
          }
      }
  </script>
</body>
</html>
